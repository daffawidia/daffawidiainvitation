<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Daffa ❤️ Widia Wedding</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">

    <!-- simplyCountdown -->
    <link rel="stylesheet" href="countdown/default.css"/>
    <script src="countdown/simplyCountdown.umd.js"></script>

    <!-- Bootstrap icon -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

    <link rel="stylesheet" href="style.css">       
</head>

<body>

    <section id="hero"
        class="hero w-100 h-100 p-3 mx-auto text-center d-flex justify-content-center align-items-center text-white">
        <main>
            <h5>Undangan Pernikahan</h5>
            <h4>Kepada <span>Bapak/Ibu/Saudara/i, </span></h4>
            <h1>Muhammad Daffa Mulya</h1>
            <h2>&</h2>
            <h3>Widia Dahita Afsari</h3>
            <p>Akan melangsungan resepsi pernikahan dalam:</p>
            <div class="simply-countdown"></div>
            <a href="#home" class="btn btn-lg mt-4" onClick="enableScroll()">Lihat Undangan</a>
        </main>
    </section>

    <nav class="navbar navbar-expand-md bg-transparent sticky-top mynavbar">
        <div class="container">
            <a class="navbar-brand" href="#">Daffa & Widia Wedding</a>
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Daffa & Widia Wedding</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <div class="navbar-nav ms-auto">
                        <a class="nav-link" href="#home">Home</a>
                        <a class="nav-link" href="#info">Info</a>
                        <a class="nav-link" href="#story">Story</a>
                        <a class="nav-link" href="#gallery">Gallery</a>
                        <a class="nav-link" href="#rsvp">RSVP</a>
                        <a class="nav-link" href="#expression">expression</a>
                        <a class="nav-link" href="#gifts">Gifts</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <section id="home" class="home">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 text-center">
                    <h2>Acara Pernikahan</h2>
                    <h3>Diselenggaraan pada 07 September 2025 di Cirebon, Jawa Barat</h3>
                    <p>Oleh karena itu, dengan segala hormat, kami bermaksud untuk mengundang Bapak/Ibu, Saudara/i, untuk hadir
                        pada acara pernikahan kami</p>
                </div>
            </div>

            <div class="row couple">
                <div class="col-lg-6">
                    <div class="row">
                        <div class="col-8 text-end">
                            <h3>Muhammad Daffa Mulya</h3>
                            <ul class="mt-3">
                                <li>
                                    <a href="https://instagram.com/mdaffamy"><i class="bi bi-instagram"></i></a>
                                    <a href="https://instagram.com/mdaffamy">@mdaffamy</a>
                                </li>
                            </ul>
                            <p>Putra dari Bpk. Asep Mulya Suwarno <br> dan <br> Ibu. Siti Robiah</p>
                        </div>
                        <div class="col-4">
                            <img src="img/pria.png" alt="Muhammad Daffa Mulya" class="img-responsive rounded-circle">
                        </div>
                    </div>
                </div>

                <span class="heart"><i class="bi bi-heart-fill"></i></span>

                <div class="col-lg-6">
                    <div class="row">
                        <div class="col-4">
                            <img src="img/wanita.png" alt="Widia Dahita Afsari" class="img-responsive rounded-circle">
                        </div>
                        <div class="col-8">
                            <h3>Widia Dahita Afsari</h3>
                            <ul class="mt-3">
                                <li>
                                    <a href="https://instagram.com/widiaafsri"><i class="bi bi-instagram"></i></a>
                                    <a href="https://instagram.com/widiaafsri">@widiaafsri</a>
                                </li>
                            </ul>
                            <p>Putri dari Bpk. Main <br> dan <br> Ibu. Rokanah</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="info" class="info">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 col-10 text-center">
                    <h2>Informasi Acara</h2>
                    <p class="alamat">ALAMAT : Blok Manis, RT/001 RW/002<br>Desa Japura Lor, Kec.Pangenan, Kab.Cirebon</p>
                    <iframe src="https://www.google.com/maps/embed?pb=!1m17!1m12!1m3!1d3961.729882717092!2d108.636122!3d-6.802679!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m2!1m1!2zNsKwNDgnMDkuNiJTIDEwOMKwMzgnMTAuMCJF!5e0!3m2!1sid!2sid!4v1751446945080!5m2!1sid!2sid" width="100%" height="250" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    <a href="https://maps.app.goo.gl/fvFcQtn5SJTLb8DL9?g_st=aw" target="_blank" class="btn btn-light btn-sm my-4">Klik untuk membuka peta</a>
                    <p class="description">Diharapakan untuk tidak salah alamat dan tanggal. Manakala tiba di tujuan namun tidak
                        ada tanda tanda sedang dilangsungkan pernikahan, boleh jadi Anda salah jadwal, atau salah tempat.
                    </p>
                </div>
            </div>
            <div class="row justify-content-center mt-5">
                <div class="col-md-5 col-10">
                    <div class="card text-center text-bg-light mb-5">
                        <div class="card-header">Akad Nikah</div>
                        <div class="card-body">
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <i class="bi bi-clock d-block"></i>
                                    <span>08.00 - 10.00</span>
                                </div>
                                <div class="col-md-6">
                                    <i class="bi bi-calendar3 d-block"></i>
                                    <span>Minggu, 7 September 2025.</span>
                                </div>
                            </div>
                        <div class="card-footer">
                        Saat acara akad diharapkan untuk kondusif menjaga kehidmatan dan kekhusyuan seluruh prosesi.
                        </div>
                    </div>
                </div>
            </div>
                <div class="col-md-5 col-10">
                    <div class="card text-center text-bg-light mb-5">
                        <div class="card-header">Resepsi</div>
                        <div class="card-body">
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <i class="bi bi-clock d-block"></i>
                                    <span>11.00 - selesai</span>
                                </div>
                                <div class="col-md-6">
                                    <i class="bi bi-calendar3 d-block"></i>
                                    <span>Minggu, 7 September 2025.</span>
                                </div>
                            </div>
                        <div class="card-footer">
                        Saat acara berlangsung diharapkan untuk kondusif menjaga kehidmatan dan kekhusyuan seluruh prosesi.
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <section id="story" class="story">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md8 col-10 text-center">
                    <b>Bagaimana Cinta Kami Bersemi</b>
                    <h2>Cerita kami</h2>
                    <p>Pertemuan Pertama hingga Pernikahan</p>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <ul class="timeline">
                        <li>
                            <div class="timeline-image" style="background-image: url(img/awal.png);"></div>
                            <div class="timeline-panel">
                                <div class="timeline-heading">
                                    <h3>Awal Perkenalan</h3>
                                    <span>30 Desember 2021</span>
                                </div>
                                <div class="timeline-body">
                                    <a>Tidak ada yang kebetulan di dunia ini, semua sudah tersusun rapih oleh Allah SWT. Kita tidak bisa memilih kepada siapa kita jatuh cinta. Awal kita kenalan pada tahun 2021, melalui jaringan sosmed yaitu Facebook. Tidak ada yang menyangka perkenalan itu membawa kami pada suatu ikatan suci.</a>
                                </div>
                            </div>
                        </li>
                        <li class="timeline-inverted">
                            <div class="timeline-image" style="background-image: url(img/lamaran.png);"></div>
                            <div class="timeline-panel">
                                <div class="timeline-heading">
                                    <h3>Lamaran</h3>
                                    <span>26 Mei 2024</span>
                                </div>
                                <div class="timeline-body">
                                    <a>Katanya cinta dapat tumbuh dengan kebersamaan. Seiring berjalannya waktu pada 26 Mei 2024 kami memutuskan untuk saling mengenal lebih jauh , bukan hanya diri pribadi tetapi juga dengan kedua keluarga.</a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="timeline-image" style="background-image: url(img/menikah.png);"></div>
                            <div class="timeline-panel">
                                <div class="timeline-heading">
                                    <h3>Menikah</h3>
                                    <span>7 September 2025 Kita Menikah</span>
                                </div>
                                <div class="timeline-body">
                                    <a>Bukan karena bertemu lalu berjodoh tetapi karena berjodohlah kami dipertemukan. Atas izin Allah, kami memutuskan untuk memulai menunaikan ibadah terpanjang yaitu Menikah yang insyaAllah akan dilaksakan pada bulan September 2025, Sebagaimana yang pernah dikatakan oleh Sayyidina Ali bin Abi Thalib "Apa yang menjadi takdirmu akan menemukan jalannya untuk menemukanmu".</a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <section id="gallery" class="gallery">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md8 col-10 text-center">
                    <span>Momen</span>
                    <h2>Gallery</h2>
                    <p>Momen ini adalah janji bahwa kita akan bersama selamanya</p>
                </div>
            </div>
            <div class="row row-cols-md-3 row-cols-sm-2 row-cols-1 justify-content-center">
                <div class="col mt-3">
                    <a href="img/gallery/1.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/1.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/5.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/5.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/3.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/3.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/6.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/6.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/2.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/2.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/7.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/7.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/4.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/4.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/8.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/8.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/9.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/9.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
                <div class="col mt-3">
                    <a href="img/gallery/10.png" data-toggle="lightbox" data-caption="This describes the image" data-gallery="mygallery">
                        <img src="img/gallery/thumbnail/10.png" alt="Daffa & Widia 1" class="img-fluid w-100 rounded">
                    </a>
                </div>
            </div>
        </div>
    </section>

    <section id="rsvp" class="rsvp">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md8 col-10 text-center">
                    <h2>Konfirmasi Kehadiran</h2>
                    <p>Isi form di bawah ini untuk melakukan konfirmasi Kehadiran.</p>
                </div>
            </div>

            <form class="row row-cols-md-auto g-3 align-items-center justify-content-center" method="POST" action="https://script.google.com/macros/s/AKfycbxSD5skFK2uP9Z99ae3uZn_P4WSeTN_qX1aJkwuh6Uf7V-wwX8Os9ovN_swhBPgF5DU/exec" id="my-form">
                <div class="col-12">
                    <div class="mb-3">
                        <label for="nama" class="form-label">Nama</label>
                        <input type="text" class="form-control" id="nama" name="nama">
                    </div>
                </div>
                <div class="col-12">
                    <div class="mb-3">
                        <label for="jumlah" class="form-label">jumlah</label>
                        <input type="number" class="form-control" id="jumlah" name="jumlah" min="1" max="5" length="1" value="1">
                    </div>
                </div>
                <div class="col-12">
                    <div class="mb-3">
                        <label for="status" class="form-label">Konfirmasi</label>
                        <select name="status" id="status" class="form-select">
                            <option selected>Pilih salah satu</option>
                            <option value="Hadir">Hadir</option>
                            <option value="Tidak Hadir">Tidak Hadir</option>
                        </select>
                    </div>
                </div>
                <div class="col-12" style="margin-top: 35px;">
                    <button class="btn btn-primary">Kirim</button>
                </div>
            </form>

            <div class="row justify-content-center mt-5">
                <div class="wishes-section">
                    <h2 class="section-title">Ucapan & Doa</h2>
            
                    <div class="wish-form">
                        <div class="form-group">
                            <textarea id="wish-text" placeholder="Tulis ucapan atau doa untuk mempelai..."></textarea>
                        </div>
                        <div class="form-group">
                            <div class="upload-wrapper">
                                <label for="wish-image" class="upload-btn">Unggah Gambar</label>
                                <input type="file" id="wish-image" class="file-input" accept="image/*">
                                <span id="file-name" class="file-name"></span>
                            </div>
                        </div>
                        <button id="submit-wish" class="submit-btn">Kirim</button>
                    </div>
            
                    <div class="wishes-container" id="wishes-container">
                        <!-- Wish items will be loaded here -->
                    </div>
            
                    <div class="load-more hidden" id="load-more">
                        <button class="load-more-btn" id="load-more-btn">Lihat Selanjutnya</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="gifts" class="gifts">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md8 col-10 text-center">
                    <span>ungkapan tanda kasih</span>
                    <h2>Kirim Hadiah</h2>
                    <p>Terima kasih atas hadiah yang begitu berharga ini. Saya sangat menghargainya.</p>
                </div>
            </div>

            <div class="row justify-content-center text-center">
                <div class="col-md-6">
                    <ul class="list-group">
                        <li class="list-group-item">
                            <div><img src="img/BRI.png" alt="BRI" class="img-thumbnail" width="100"></div>
                            <div class="fw-bold">MUHAMMAD DAFFA MULYA</div>
                            <div class="copy-text">
                                <h1 class="copy-text" id="text">
                                    037701044462506
                                    <i onclick="copyText()" class="bi bi-copy"></i>
                                </h1>
                                <div class="copied-msg" id="copiedMsg">Copied!</div>
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div><img src="img/seabank.png" alt="BRI" class="img-thumbnail" width="100"></div>
                            <div class="fw-bold">WIDIA DAHITA AFSARI</div>
                            <div class="copy-text">
                                <h1 class="copy-text" id="text">
                                    901017303417
                                    <i onclick="copyText()" class="bi bi-copy"></i>
                                </h1>
                                <div class="copied-msg" id="copiedMsg">Copied!</div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col text-center">
                    <small class="block">&copy; 2025 Daffa & Widia Wedding. All Rights Reserved</small>
                    <small class="block">Design by <a href="https://instagram.com/rhmtfdl.z">@rhmtfdl.z</a>.</small>

                    <ul class="mt-3">
                        <li>
                            <a href="https://instagram.com/rhmtfdl.z"><i class="bi bi-instagram"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <div id="audio-container">
        <audio id="song" autoplay loop>
            <source src="audio/sinarengan.mp3" type="audio/mp3">
        </audio>

        <div class="audio-icon-wrapper" style="display: none;">
            <i class="bi bi-disc"></i>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous">
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bs5-lightbox@1.8.5/dist/index.bundle.min.js">
    </script>    

    <script>
        simplyCountdown('.simply-countdown', {
            year: 2025, // Target year (required)
            month: 9, // Target month [1-12] (required)
            day: 7, // Target day [1-31] (required)
            hours: 8, // Target hour [0-23], default: 0
            minutes: 0, // Target minute [0-59], default: 0
            seconds: 0, // Target second [0-59], default: 0
            words: { // Custom labels, with lambda for plurals
                days: { root: 'hari', lambda: (root, n) => n > 1 ? root + '' : root },
                hours: { root: 'jam', lambda: (root, n) => n > 1 ? root + '' : root },
                minutes: { root: 'menit', lambda: (root, n) => n > 1 ? root + '' : root },
                seconds: { root: 'detik', lambda: (root, n) => n > 1 ? root + '' : root }
            },
        });
    </script>

    <script>
        const hamburger = document.querySelector('.navbar-toggler');
        const stickTop = document.querySelector('.sticky-top');
        const offcanvas = document.querySelector('.offcanvas');
        
        hamburger.addEventListener('click', function() {
            stickTop.style.overflow = 'visible';
        });
        
        offcanvas.addEventListener('hidden.bs.offcanvas', function() {
            stickTop.style.overflow = 'hidden';
        });
        
    </script>

    <script>
        const rootElement = document.querySelector(":root");
        const audioIconWrapper = document.querySelector('.audio-icon-wrapper');
        const audioIcon = document.querySelector('.audio-icon-wrapper i');
        const song = document.querySelector('#song');
        let isPlaying = false;

        function disableScroll() {
            scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

            window.onscroll = function () {
                window.scrollTo(scrollTop, scrollLeft);
            }

            rootElement.style.scrollBehavior = 'auto';
        }

        function enableScroll() {
            window.onscroll = function () { }
            rootElement.style.scrollBehavior = 'smooth';
            // localStorage.setItem('opened', 'true');
            playAudio();
        }

        function playAudio() {
            song.volume = 0.1;
            audioIconWrapper.style.display = 'flex';
            song.play();
            isPlaying = true;
        }

        audioIconWrapper.onclick = function() {
            if (isPlaying) {
                song.pause();
                audioIcon.classList.remove('bi-disc');
                audioIcon.classList.add('bi-pause-circle');
            } 
            else {
                song.play();
                audioIcon.classList.add('bi-disc');
                audioIcon.classList.remove('bi-pause-circle');
            }

            isPlaying = !isPlaying;
        }

        // if (!localStorage.getItem('opened')) {
        //    disableScroll();
        // }
        disableScroll();
    </script>

    <script>
        window.addEventListener("load", function () {
            const form = document.getElementById('my-form');
            form.addEventListener("submit", function(e) {
                e.preventDefault();
                const data = new FormData(form);
                const action = e.target.action;
                fetch(action, {
                    method: 'POST',
                    body: data,
                })
                .then(() => {
                    alert("Konfirmasi Berhasil Terkirim");
                })
            });
        });
    </script>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const nama = urlParams.get('n') || '';
        const pronoun = urlParams.get('p') || 'Saudara/i';
        const namaContainer = document.querySelector('.hero h4 span');
        namaContainer.innerText = `${pronoun} ${nama},`.replace(/ ,$/, ',');

        document.querySelector('#nama').value = nama;
    </script>

    <script>
        async function copyText() {
            const p = document.getElementById("text");
            try{
                await navigator.clipboard.writeText(p.textContent);
                const msg = document.getElementById("copiedMsg");
                msg.style.display="block"
                setTimeout(()=>{
                    msg.style.display="none"
                },1000);
            }
            catch (err) {
                alert("failed to copy" + err);
            }
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize
            const wishesKey = 'wedding_wishes';
            let allWishes = JSON.parse(localStorage.getItem(wishesKey)) || [];
            let displayedCount = 0;
            const maxInitialDisplay = 5;
            
            // DOM Elements
            const wishesContainer = document.getElementById('wishes-container');
            const wishText = document.getElementById('wish-text');
            const wishImage = document.getElementById('wish-image');
            const fileName = document.getElementById('file-name');
            const submitBtn = document.getElementById('submit-wish');
            const loadMoreBtn = document.getElementById('load-more-btn');
            const loadMoreSection = document.getElementById('load-more');
            
            // Get user name from URL
            const urlParams = new URLSearchParams(window.location.search);
            const userName = urlParams.get('n') || 'Tamu Undangan';
            
            // Event listeners
            wishImage.addEventListener('change', updateFileName);
            submitBtn.addEventListener('click', submitWish);
            loadMoreBtn.addEventListener('click', loadMoreWishes);
            
            // Initial load
            displayWishes();
            
            function updateFileName() {
                if (wishImage.files.length > 0) {
                    fileName.textContent = wishImage.files[0].name;
                } else {
                    fileName.textContent = '';
                }
            }
            
            function submitWish() {
                const text = wishText.value.trim();
                if (!text) return;
                
                const newWish = {
                    id: Date.now().toString(),
                    name: userName,
                    date: new Date().toLocaleString('id-ID'),
                    text: text,
                    image: null,
                    reactions: {},
                    replies: []
                };
                
                // Handle image upload
                if (wishImage.files.length > 0) {
                    const file = wishImage.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        newWish.image = e.target.result;
                        saveWish(newWish);
                    };
                    
                    reader.readAsDataURL(file);
                } else {
                    saveWish(newWish);
                }
            }
            
            function saveWish(wish) {
                allWishes.unshift(wish);
                localStorage.setItem(wishesKey, JSON.stringify(allWishes));
                
                // Clear form
                wishText.value = '';
                wishImage.value = '';
                fileName.textContent = '';
                
                // Refresh display
                displayedCount = 0;
                displayWishes();
            }
            
            function displayWishes() {
                wishesContainer.innerHTML = '';
                const wishesToDisplay = allWishes.slice(0, displayedCount + maxInitialDisplay);
                
                if (allWishes.length > maxInitialDisplay && displayedCount === 0) {
                    loadMoreSection.classList.remove('hidden');
                }
                
                wishesToDisplay.forEach(wish => {
                    const wishElement = createWishElement(wish);
                    wishesContainer.appendChild(wishElement);
                });
                
                displayedCount += maxInitialDisplay;
                
                if (displayedCount >= allWishes.length) {
                    loadMoreSection.classList.add('hidden');
                }
            }
            
            function loadMoreWishes() {
                displayWishes();
            }
            
            function createWishElement(wish) {
                const wishDiv = document.createElement('div');
                wishDiv.className = 'wish-item';
                wishDiv.dataset.id = wish.id;
                
                // Wish header
                const headerDiv = document.createElement('div');
                headerDiv.className = 'wish-header';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'wish-name';
                nameSpan.textContent = wish.name;
                
                const dateSpan = document.createElement('span');
                dateSpan.className = 'wish-date';
                dateSpan.textContent = wish.date;
                
                headerDiv.appendChild(nameSpan);
                headerDiv.appendChild(dateSpan);
                
                // Wish content
                const contentDiv = document.createElement('div');
                contentDiv.className = 'wish-content';
                contentDiv.textContent = wish.text;
                
                // Wish image if exists
                let imageDiv;
                if (wish.image) {
                    imageDiv = document.createElement('div');
                    const img = document.createElement('img');
                    img.src = wish.image;
                    img.className = 'wish-image';
                    img.alt = 'Gambar ucapan dari ' + wish.name;
                    imageDiv.appendChild(img);
                }
                
                // Wish actions
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'wish-actions';
                
                // Reaction buttons
                const reactions = ['👍', '❤️', '🤲'];
                reactions.forEach(reaction => {
                    const reactionBtn = document.createElement('button');
                    reactionBtn.className = 'reaction-btn';
                    reactionBtn.textContent = reaction;
                    reactionBtn.dataset.reaction = reaction;
                    
                    const countSpan = document.createElement('span');
                    countSpan.className = 'reaction-count';
                    countSpan.textContent = wish.reactions[reaction] || '';
                    
                    const reactionContainer = document.createElement('span');
                    reactionContainer.appendChild(reactionBtn);
                    reactionContainer.appendChild(countSpan);
                    
                    reactionBtn.addEventListener('click', function() {
                        addReaction(wish.id, reaction);
                    });
                    
                    actionsDiv.appendChild(reactionContainer);
                });
                
                // Reply button
                const replyBtn = document.createElement('button');
                replyBtn.className = 'reply-btn';
                replyBtn.textContent = 'Balas';
                replyBtn.addEventListener('click', function() {
                    showReplyForm(wish.id);
                });
                
                actionsDiv.appendChild(replyBtn);
                
                // Replies container
                let repliesDiv;
                if (wish.replies.length > 0) {
                    repliesDiv = document.createElement('div');
                    repliesDiv.className = 'replies-container';
                    
                    wish.replies.forEach(reply => {
                        const replyElement = createReplyElement(reply);
                        repliesDiv.appendChild(replyElement);
                    });
                }
                
                // Build wish element
                wishDiv.appendChild(headerDiv);
                wishDiv.appendChild(contentDiv);
                
                if (imageDiv) {
                    wishDiv.appendChild(imageDiv);
                }
                
                wishDiv.appendChild(actionsDiv);
                
                if (repliesDiv) {
                    wishDiv.appendChild(repliesDiv);
                }
                
                return wishDiv;
            }
            
            function createReplyElement(reply) {
                const replyDiv = document.createElement('div');
                replyDiv.className = 'reply-item';
                
                const headerDiv = document.createElement('div');
                headerDiv.className = 'wish-header';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'wish-name';
                nameSpan.textContent = reply.name;
                
                const dateSpan = document.createElement('span');
                dateSpan.className = 'wish-date';
                dateSpan.textContent = reply.date;
                
                headerDiv.appendChild(nameSpan);
                headerDiv.appendChild(dateSpan);
                
                const contentDiv = document.createElement('div');
                contentDiv.className = 'wish-content';
                contentDiv.textContent = reply.text;
                
                replyDiv.appendChild(headerDiv);
                replyDiv.appendChild(contentDiv);
                
                return replyDiv;
            }
            
            function addReaction(wishId, reaction) {
                const wish = allWishes.find(w => w.id === wishId);
                if (!wish) return;
                
                // Initialize reactions object if not exists
                if (!wish.reactions) {
                    wish.reactions = {};
                }
                
                // Toggle reaction
                wish.reactions[reaction] = wish.reactions[reaction] ? 
                    wish.reactions[reaction] + 1 : 1;
                
                // Save and refresh
                localStorage.setItem(wishesKey, JSON.stringify(allWishes));
                
                // Update UI
                const wishElement = document.querySelector(`.wish-item[data-id="${wishId}"]`);
                const reactionCount = wishElement.querySelector(`button[data-reaction="${reaction}"] + .reaction-count`);
                reactionCount.textContent = wish.reactions[reaction];
            }
            
            function showReplyForm(wishId) {
                const wishElement = document.querySelector(`.wish-item[data-id="${wishId}"]`);
                const repliesContainer = wishElement.querySelector('.replies-container') || 
                    document.createElement('div');
                
                if (!wishElement.querySelector('.reply-form')) {
                    repliesContainer.className = 'replies-container';
                    
                    const formDiv = document.createElement('div');
                    formDiv.className = 'reply-form';
                    
                    const textarea = document.createElement('textarea');
                    textarea.placeholder = 'Tulis balasan...';
                    
                    const btn = document.createElement('button');
                    btn.className = 'submit-btn';
                    btn.textContent = 'Kirim Balasan';
                    btn.style.marginTop = '10px';
                    
                    formDiv.appendChild(textarea);
                    formDiv.appendChild(btn);
                    
                    btn.addEventListener('click', function() {
                        const replyText = textarea.value.trim();
                        if (replyText) {
                            addReply(wishId, replyText);
                            formDiv.remove();
                        }
                    });
                    
                    repliesContainer.prepend(formDiv);
                    wishElement.appendChild(repliesContainer);
                }
            }
            
            function addReply(wishId, text) {
                const wish = allWishes.find(w => w.id === wishId);
                if (!wish) return;
                
                // Initialize replies array if not exists
                if (!wish.replies) {
                    wish.replies = [];
                }
                
                const newReply = {
                    name: userName,
                    date: new Date().toLocaleString('id-ID'),
                    text: text
                };
                
                wish.replies.unshift(newReply);
                localStorage.setItem(wishesKey, JSON.stringify(allWishes));
                
                // Update UI
                const wishElement = document.querySelector(`.wish-item[data-id="${wishId}"]`);
                const repliesContainer = wishElement.querySelector('.replies-container');
                const replyElement = createReplyElement(newReply);
                
                if (repliesContainer) {
                    repliesContainer.insertBefore(replyElement, repliesContainer.firstChild);
                }
            }
        });
    </script>
</body>

</html>
